<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Download Table as PDF | Zouraiz</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0&icon_names=download"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="card">
        <header>
          <h2>Students</h2>
          <button type="button" id="download-btn">
            <span class="material-symbols-outlined"> download </span>
            Download
          </button>
        </header>
        <div class="wrapper">
          <table id="student-table">
            <thead>
              <tr>
                <th>
                  Name
                  <span class="draggable" onmousedown="initResize(0)"></span>
                </th>
                <th>
                  Age
                  <span class="draggable" onmousedown="initResize(1)"></span>
                </th>
                <th>Level</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Sarah Khan</td>
                <td>22</td>
                <td>Intermediate</td>
              </tr>
              <tr>
                <td>Ayesha Malik</td>
                <td>24</td>
                <td>Expert</td>
              </tr>
              <tr>
                <td>Usman Tariq</td>
                <td>20</td>
                <td>Beginner</td>
              </tr>
              <tr>
                <td>Maria Sheikh</td>
                <td>19</td>
                <td>Expert</td>
              </tr>
              <tr>
                <td>Ali Raza</td>
                <td>25</td>
                <td>Beginner</td>
              </tr>
              <tr>
                <td>Zain Abbas</td>
                <td>30</td>
                <td>Intermediate</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

    <!-- Include jsPDF library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

    <script type="text/javascript">
      // Table column resizing functionality
      const columns = document.querySelectorAll("table thead th");
      const wrapper = document.querySelector(".wrapper");
      let activeIndex;

      const resize = (e) => {
        const nextWidth = e.clientX - columns[activeIndex].offsetLeft - wrapper.offsetLeft - 24;
        columns[activeIndex].width = nextWidth;
      };

      const stopResize = (e) => {
        document.body.style.cursor = "default";
        window.removeEventListener("mousemove", resize);
        window.removeEventListener("mouseup", stopResize);
      };

      const initResize = (index) => {
        activeIndex = index;
        document.body.style.cursor = "col-resize";
        window.addEventListener("mousemove", resize);
        window.addEventListener("mouseup", stopResize);
      };

      // Download table as PDF functionality
      document.getElementById("download-btn").addEventListener("click", function () {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        // Capture table HTML
        const table = document.getElementById("student-table");

        // Add table to PDF using autoTable plugin
        doc.text("Student Data", 14, 16);
        doc.autoTable({
          head: [['Name', 'Age', 'Level']], // Table headers
          body: Array.from(table.querySelectorAll('tbody tr')).map(row => 
            Array.from(row.querySelectorAll('td')).map(cell => cell.innerText)
          ),
          startY: 20
        });

        // Save the PDF
        doc.save("student_data.pdf");
      });
    </script>
  </body>
</html>
